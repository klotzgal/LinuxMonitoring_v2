
## Part 9. Дополнительно. Свой *node_exporter*

**== Задание ==**

Написать bash-скрипт или программу на Си, которая собирает информацию по базовым метрикам системы (ЦПУ, оперативная память, жесткий диск (объем)).
Скрипт или программа должна формировать html страничку по формату **Prometheus**, которую будет отдавать **nginx**. \
Саму страничку обновлять можно как внутри bash-скрипта или программы (в цикле), так и при помощи утилиты cron, но не чаще, чем раз в 3 секунды.
##### Поменять конфигурационный файл **Prometheus**, чтобы он собирал информацию с созданной вами странички.

1. Написал скрипт для сбора базовых метрик системы и формирования html.
!["Script"](../../misc/images/screens/9.1.png)
2. Поправил nginx.conf для выдачи сформированного html по адресу http://localhost:12345/metrics/
!["NGINX"](../../misc/images/screens/9.2.png)
3. Добавил в prometheus.yml новый job
!["NGINX"](../../misc/images/screens/9.3.png)
4. Перезапустил NGINX и Prometheus
5. Проверил Prometheus
!["Prometheus"](../../misc/images/screens/9.4.png)
6. Написал start.sh, который размещает конфиги в нужных папках и запускает обновление страницы.
Запускать его следует с sudo для того, чтобы были права на редактирование папок и перезапуска NGINX и Prometheus.
7. Создал в Grafana дашборд на подобии пункта 7, использующий полученные метрики.
!["Dashboard "](../../misc/images/screens/9.5.png)



##### Провести те же тесты, что и в [Части 7](#part-7-prometheus-и-grafana)
1. Запуск скрипта из 2 части
!["Test"](../../misc/images/screens/9.test1.png)
2. Отчистка скрипта
!["Test"](../../misc/images/screens/9.test2.png)
3. stress -c 2 -i 1 -m 1 --vm-bytes 32M -t 10s
!["Test"](../../misc/images/screens/9.test3.png)

